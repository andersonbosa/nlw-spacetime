version: '3.4'

services:
  server_fastify:
    build:
      context: ./services/server-fastify
      dockerfile: Dockerfile
    environment:
      - FASTIFY_SERVER_PORT=3333
      # - NODE_OPTIONS=--inspect=0.0.0.0:9229
    networks:
      - spacetime-private-net
    volumes:
      - ./services/server-fastify:/server
      # - node_modules:/server/node_modules
      - /server/node_modules
    ports:
      - "3333:3333"
  # TOFIX Is not working ðŸ˜¥ - The dockerfile workds, but here, nope
  # app_web:
  #   # depends_on:
  #   #   - server_fastify
  #   build:
  #     context: ./services/app-web
  #     dockerfile: Dockerfile
  #     args:
  #       - NEXTJS_PORT=3000
  #   environment:
  #     - PORT=3000
  #     - FASTIFY_SERVER_PORT=3333
  #   networks:
  #     - spacetime-private-net
  #   volumes:
  #     - ./services/app-web:/app
  #     - /app/node_modules
  #     # - node_modules:/app/node_modules
  #   ports:
  #     - "3000:3000"
  #   tmpfs:
  #     - /app/.next


volumes:
  node_modules: {}

networks:
  spacetime-private-net:
